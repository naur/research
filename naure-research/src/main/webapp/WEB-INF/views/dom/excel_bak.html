<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <link href="http://cdn.naure.org/css/default.css" rel="stylesheet" type="text/css"/>
    <link href="http://cdn.naure.org/css/naure.message.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="http://cdn.naure.org/js/core/require.js"></script>
    <style>
        thead tr, tbody tr td.name {
            display: none;
        }

        table tbody tr {
            text-align: right;
        }

        table tbody tr td.name, table tbody tr td.code {
            text-align: center;
        }

        input {
            border: 0px;
            background-color: #ffffff;
        }
    </style>
</head>
<body style="background-color: #ffffff;">
<iframe width="500" height="500" src="http://view.officeapps.live.com/op/view.aspx?src=http%3A%2F%2Fcdn.naure.org%2Ftest.xlsx"></iframe>
</body>

<script>
    require.config({
        paths: {
            'jquery': 'http://code.jquery.com/jquery-2.1.0.min',
            'jquery.strings': 'http://cdn.naure.org/js/core/jquery.strings',
            'oop': 'http://cdn.naure.org/js/core/oop',
            'naure': 'http://cdn.naure.org/js/core/naure',
            'naure.utility': 'http://cdn.naure.org/js/core/naure.utility',
            'naure.message': 'http://cdn.naure.org/js/core/naure.message',
            'naure.http.xmlhttp': 'http://cdn.naure.org/js/core/naure.http.xmlhttp'
        },
        shim: {
            'jquery.strings': ['jquery']
        }
    });

    var global = {}, openDocObj = new ActiveXObject("SharePoint.OpenDocuments.2");

//    if (openDocObj) {
//        var launcherCLSID = openDocObj.GetCLSID();
//        var objectTag = '<OBJECT classid="clsid:' + launcherCLSID + '" id="OpenDocuments" style="display:none;"></OBJECT>';
//
//        document.write(objectTag);
//    }

    function DoImportSpreadsheet() {
        var form = document.frmNewList;
        var resultUrl;

        resultUrl = SpreadsheetLauncherObj.ImportList("http://cdn.naure.org/test.xlsx", " ", false, 'http://STSServer1/_vti_bin/owssvr.dll?CS=109&');
        window.parent.location.assign(resultUrl);
        return false;
    }

    function init() {
//        global.openDocObj = new ActiveXObject("SharePoint.OpenDocuments.2");
//        global.openDocObj.EditDocument("http://cdn.naure.org/test.xlsx");
        //openDocObj.EditDocument("http://cdn.naure.org/test.xlsx");
//
//        var word = new ActiveXObject("Excel.Application");
//
//        word.Visible = true;
//        word.Documents.Open("http://cdn.naure.org/test.xlsx");
    }

    require(['jquery', 'jquery.strings', 'naure.http.xmlhttp', 'naure.message', 'naure.utility'], function ($, $1, NAURE) {
        global.http = NAURE.HTTP;
        global.message = NAURE.Message;
        global.utility = NAURE.Utility;
        $('body').message({overlay: 'left-bottom', multiple: false, title: ''});
        init();
        $(function () {
        });
    });
</script>

</html>
